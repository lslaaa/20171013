!function(a){"use strict";a.fn.extend({WMZoom:function(b){var c={config:{stageW:500,stageH:400,inner:!1,position:"right",margin:10}},b=a.extend(!0,c,b);return this.each(function(){var c,d=a(this),e=d.find(".wm-zoom-box"),f=e.find("img"),g=f.attr("data-loader-src"),h=a("<div />").addClass("wm-zoom-lens"),i=a("<div />").addClass("wm-zoom-hight"),j=a("<img />").addClass("wm-zoom-loader").attr("src",g);e.append(h),i.html(j),e.prepend(i);var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=function(){k=f.width(),l=f.height(),m=d.offset(),b.config.inner===!0?(J=k,K=l):(J=b.config.stageW,K=b.config.stageH),e.css({height:l+"px",width:k+"px"}),i.css({height:K+"px",width:J+"px"}),b.config.inner===!0?i.css({top:"0px",left:"0px"}):("right"===b.config.position&&i.css({top:"0px",left:k+b.config.margin+"px"}),"bottom"===b.config.position&&i.css({top:l+b.config.margin+"px",left:"0px"}),"top"===b.config.position&&i.css({top:"-"+(K+b.config.margin)+"px",left:"0px"}),"left"===b.config.position&&i.css({top:"0px",left:"-"+(J+b.config.margin)+"px"}))},M=function(){p=j.width(),q=j.height(),r=J/2-p/2,s=K/2-q/2,j.css({top:s+"px",left:r+"px"})},N=function(){if(c.length<1){var b=f.attr("data-hight-src");if(0==n){n=!0,o=!1;var d=new Image;a(d).addClass("wm-zoom-hight-img").attr("src",b).load(function(){c.remove(),i.append(d),o=!0})}}else n=!0,o=!0},O=function(){L(),n=!1,o=!1,e.mouseenter(function(){b.config.inner!==!0&&h.stop().fadeIn(300),i.stop().fadeIn(300),M()}).mousemove(function(b){return a(this),c=i.find("img.wm-zoom-hight-img"),N(),1!=o&&1!=n?!1:(t=i.width(),u=i.height(),v=c.width(),w=c.height(),x=J*k/v,y=K*l/w,z=x/2,A=y/2,y>l&&(y=l),x>k&&(x=k),h.css({width:x,height:y}),B=b.pageX-m.left,C=b.pageY-m.top,(B>k||0>B||C>l||0>C)&&(h.hide(),i.hide()),D=B-z,0>D?D=0:D>k-x&&(D=k-x),E=C-A,0>E?E=0:E>l-y&&(E=l-y),h.css({left:D+"px",top:E+"px"}),F=(v-t/2)/(k-z),G=Math.ceil(F*D),G>v-t&&(G=v-t),H=(w-u/2)/(l-A),I=Math.ceil(H*E),I>w-u&&(I=w-u),void c.css({left:"-"+G+"px",top:"-"+I+"px"}))}).mouseleave(function(){h.stop().fadeOut(300),i.stop().fadeOut(300)})};a(window).load(function(){setTimeout(function(){O()},25)})})}})}(jQuery);