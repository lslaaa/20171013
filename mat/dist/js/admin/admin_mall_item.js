var admin_item_edit={str_ids:"",_init:function(){admin_item_edit._listen_cat(),admin_item_edit._listen_upload(),admin_item_edit._listen_send()},_listen_cat:function(){var a=admin_item_edit,b=$("#J_cid_1");if(b.change(function(){var b=$(this),c=b.val();a._cat_select(c)}),b.attr("data-cid")>0){for(var c=b.attr("data-cid"),d=b.children(),e=0;e<d.length;e++){var f=d.eq(e);if(f.val()==c){f.attr("selected",!0);break}}a._cat_select(b.attr("data-cid"))}},_cat_select:function(a){var b="",c=admin_item_edit;if(a>0)for(var d,e=$("#J_cid_2").attr("data-cid"),f=0;d=c.json_cat[f++];)if(d.pid==a){var g=e==d.cid?' selected="selected"':"";b+='<option value="'+d.cid+'"'+g+">"+d.name+"</option>"}b?(b='<option value="0">'+arr_language.select+"</option>"+b,$("#J_cid_2").css("display","")):$("#J_cid_2").css("display","none"),$("#J_cid_2").html(b)},_listen_upload:function(){var a=admin_item_edit;$("#J_pic").change(function(){return $("#J_form_do").val("upload"),$("#J_upload_type").val("main_pic"),a.bool_sending?!1:($(".J_sku_pic_upload_btn").attr("disabled",!0),a.bool_sending=!0,_ajax_frame(get_obj("ajaxframeid"),a.upload_success,"send_success"),void $("#J_send_form").submit())})},_listen_sku_upload:function(){var a=admin_item_edit;$(".J_sku_pic_upload_btn").unbind("change"),$(".J_sku_pic_upload_btn").change(function(){var b=$(".J_sku_pic_upload_btn").index(this);return $("#J_form_do").val("upload"),$("#J_upload_type").val("sku_pic"),a.bool_sending?!1:($(".J_sku_pic_upload_btn,#J_pic").attr("disabled",!0),$(".J_sku_pic_upload_btn").eq(b).attr("disabled",!1),a.upload_sku_index=b,a.bool_sending=!0,_ajax_frame(get_obj("ajaxframeid"),a.upload_success,"send_success"),void $("#J_send_form").submit())})},upload_success:function(a){var b=admin_item_edit;if(_remove_ajax_frame("send_success"),$("#J_form_do").val(""),200!=a.status)return b.bool_sending=!1,make_alert_html(arr_language.warn,a.info),!1;b.bool_sending=!1;var c=b.json_config["item_"+$("#J_upload_type").val()].val;if(c=c.split("|"),c=c[1].split(","),c=c[0],"main_pic"==$("#J_upload_type").val())$("#J_pic_show").html('<img src="'+resize_img(a.data,c)+'" style="width:100px">'),$("#J_pic_url").val(a.data);else{var d='<span style=" display:table;"><em style="display:table-cell;text-align:center;vertical-align:middle; height:40px;"><img src="'+resize_img(a.data,c)+'" style="width:100%;"></em><input class="J_sku_pic" type="hidden" value="'+a.data+'"></span>';$(".J_sku_pic_list").eq(b.upload_sku_index).html(d)}$(".J_sku_pic_upload_btn,#J_pic").attr("disabled",!1)},_listen_send:function(){var a=admin_item_edit;$("#J_send_form").submit(function(){return"upload"==$("#J_form_do").val()?!0:admin_item_edit_verify._verify()&&admin_item_edit_verify._verify_sku_info()?(admin_item_edit_verify._data_format(),$(".J_sku_pic_upload_btn,#J_pic").attr("disabled",!0),$("#J_form_do").val("add"),a.bool_sending?!1:(a.bool_sending=!0,void _ajax_frame(get_obj("ajaxframeid"),a.send_success,"send_success"))):!1})},send_success:function(a){return _remove_ajax_frame("send_success"),200!=a.status?(admin_item_edit.bool_sending=!1,make_alert_html(arr_language.warn,a.info),$(".J_sku_pic_upload_btn,#J_pic").attr("disabled",!1),!1):void make_alert_html(arr_language.notice,a.info,"/admin.php?mod=item&mod_dir=mall")},_listen_bat_inactive:function(){$("#J_bat_inactive").click(function(){for(var a=$(this),b=$(".J_checkall_sub"),c="",d=0;d<b.length;d++){var e=b.eq(d);"checked"==e.attr("checked")&&(c+=e.val()+",")}return c?(_str_ids=c,confirm_cancle(admin_item_edit.bat_inactive,arr_language.warn,arr_language.del_3),void(admin_item_edit._this=a)):(make_alert_html(arr_language.warn,arr_language.no_select),!1)})},bat_inactive:function(){_ajax_jsonp("/admin.php?mod=item&mod_dir=mall&extra=bat_inactive&ids="+_str_ids,admin_item_edit.bat_inactive_success)},bat_inactive_success:function(a){make_alert_html(arr_language.notice,a.info,window.location.href)}},admin_item_del={_init:function(){admin_item_del._listen_del()},_listen_del:function(){var a=admin_item_del;$(".J_btn_del").click(function(){var b=$(this);confirm_cancle(a._del,arr_language.warn,arr_language.del_2),a._this=b})},_del:function(){var a=admin_item_del,b=a._this,c=b.attr("data-item_id");_ajax_jsonp("/admin.php?mod=item&mod_dir=mall&extra=del&item_id="+c,a._del_success)},_del_success:function(a){make_alert_html(arr_language.notice,a.info,window.location.href)}},admin_item_edit_att={_json_att_type:new Object,_json_temp_sku_data:new Object,_init:function(a){admin_item_edit_att._json_att_type=a,admin_item_edit_att._listen_type_change(),parseInt($("#J_item_id").val())>0&&admin_item_edit_att._init_type()},_init_type:function(){var a=admin_item_edit_att._json_att_type.sku_title;if(""==admin_item_edit_att._json_att_type.sku_title)return $("#J_bar_code").val(admin_item_edit_att._json_att_type.item_sku["0_0"].bar_code),$("#J_stock").val(admin_item_edit_att._json_att_type.item_sku["0_0"].stock),$("#J_free_buy_stock").val(admin_item_edit_att._json_att_type.item_sku["0_0"].free_buy_stock),!1;var b=a.length,c=$(".J_att_type"),d=new Object,e=new Object;1==b?(d=admin_item_edit_att._json_att_type.sku_1,c.eq(1).attr("checked","checked"),$(".J_sku_title").eq(0).css("display",""),$(".J_sku_title").eq(0).find("input").val(a[0]),admin_item_edit_att._listen_sku_title(0),$(".J_no_att_type").css("display","none")):2==b&&(d=admin_item_edit_att._json_att_type.sku_1,e=admin_item_edit_att._json_att_type.sku_2,c.eq(2).attr("checked","checked"),$(".J_sku_title").css("display",""),$(".J_sku_title").eq(0).find("input").val(a[0]),$(".J_sku_title").eq(1).find("input").val(a[1]),admin_item_edit_att._listen_sku_title(0),admin_item_edit_att._listen_sku_title(1),$(".J_no_att_type").css("display","none"));for(var f,g=(new Object,0);f=d[g++];)if(1==g){var h=admin_item_edit_att._make_set_sku_html(0,f.name,f.id);$(h._html).insertAfter($(".J_sku_title").eq(1))}else admin_item_edit_att._set_sku_add(0,f.name,f.id);admin_item_edit_att._listen_set_sku_add(0);for(var f,g=(new Object,0);f=e[g++];)if(1==g){var h=admin_item_edit_att._make_set_sku_html(1,f.name,f.id);$(h._html).insertAfter($(".J_set_sku").eq(0))}else admin_item_edit_att._set_sku_add(1,f.name,f.id);admin_item_edit_att._listen_set_sku_add(1),admin_item_edit_att._make_sku_list(!0),admin_item_edit._listen_sku_upload()},_listen_type_change:function(){$(".J_att_type").change(function(){var a=$(this);0==a.val()?admin_item_edit_att._remove_set_sku_html():1==a.val()?(admin_item_edit_att._remove_set_sku_html(),admin_item_edit_att._listen_sku_title(0),$(".J_no_att_type").css("display","none")):2==a.val()&&($(".J_sku_title").css("display",""),admin_item_edit_att._listen_sku_title(0),admin_item_edit_att._listen_sku_title(1),$(".J_no_att_type").css("display","none"))})},_listen_sku_title:function(a){var b=$(".J_sku_title").eq(a).find("input");b.unbind("keyup"),b.keyup(function(){var b=admin_item_edit_att._make_set_sku_html(a);b.has_html?($(".J_sku_list_title").eq(a).html(b.sku_title),$(".J_set_sku").eq(a).children("dt").html(b.sku_title+"：")):(0==a?$(b._html).insertAfter($(".J_sku_title").eq(1)):$(b._html).insertAfter($(".J_set_sku").eq(0)),admin_item_edit_att._listen_set_sku_add(a),admin_item_edit_att._listen_set_sku())})},_make_set_sku_html:function(a,b,c){"undefined"==typeof b&&(b="",c=0);var d=$(".J_sku_title").eq(a).find("input").val(),e=new Object;if(1==$(".J_set_sku").eq(a).length)return e.has_html=!0,e.sku_title=d,e;var f='<dl class="J_set_sku mt12">';return f+="<dt>"+d+"：</dt>",f+='<dd><span style="float:left;padding-bottom:5px;"><input data-sku-id="'+c+'" class="text_z J_sku_'+(a+1)+'_value" value="'+b+'"><a href="javascript:;" class="add_lsit nico J_set_sku_add" title="添加"><!--添加--></a></span></dd>',f+="</dl>",e.has_html=!1,e._html=f,e},_listen_set_sku_add:function(a){var b=$(".J_set_sku_add").eq(a);b.click(function(){var c=b.parent().parent();return c.find("input").length>=20?(make_alert_html(arr_language.notice,"每种属性最多添加20个值"),!1):void admin_item_edit_att._set_sku_add(a)})},_set_sku_add:function(a,b,c){"undefined"==typeof b&&(b="");var d=$(".J_set_sku_add").eq(a),e=d.parent().parent(),f='<span style="float:left;padding-bottom:5px;"><input data-sku-id="'+c+'" class="text_z J_sku_'+(a+1)+'_value" value="'+b+'"><a href="javascript:;" class="del_lsit nico J_set_sku_del" title="删除"><!--删除--></a></span>';e.append(f),admin_item_edit_att._listen_set_sku_del(a),admin_item_edit_att._listen_set_sku()},_listen_set_sku_del:function(a){var b=$(".J_set_sku").eq(a).find(".J_set_sku_del");b.unbind("click"),b.click(function(){var c=b.index(this);if(!confirm("该商品确定要减少一个属性值吗？执行后规格数据将无法恢复！如属性值只需修改名称，请不要继续此操作！"))return!1;b.eq(c).parent().remove(),admin_item_edit_att._listen_set_sku_del(a);var d=_temp_sku_2_del=9999999,e=$(".J_sku_1_value"),f=$(".J_sku_2_value");0==a?d=c+1:_temp_sku_2_del=c+1,admin_item_edit_att._json_temp_sku_data=new Object;for(var g=0;g<e.length;g++)if(f.length>0)for(var h=0;h<f.length;h++){var i=d>g?g:g+1,j=h<_temp_sku_2_del?h:h+1,k=g+"_"+h,l=i+"_"+j,m="J_sku_list_"+l;admin_item_edit_att._json_temp_sku_data[k]=new Object,0==h&&(admin_item_edit_att._json_temp_sku_data[k].pic=$("#"+m+" .J_sku_pic").val()),admin_item_edit_att._json_temp_sku_data[k].price=$("#"+m+" .J_sku_price").val(),admin_item_edit_att._json_temp_sku_data[k].stock=$("#"+m+" .J_sku_stock").val(),admin_item_edit_att._json_temp_sku_data[k].sku_code=$("#"+m+" .J_sku_code").val(),admin_item_edit_att._json_temp_sku_data[k].bar_code=$("#"+m+" .J_sku_bar_code").val()}else{var h=0,i=d>g?g:g+1,k=g+"_"+h,l=i+"_"+h,m="J_sku_list_"+l;admin_item_edit_att._json_temp_sku_data[k]=new Object,admin_item_edit_att._json_temp_sku_data[k].pic=$("#"+m+" .J_sku_pic").val(),admin_item_edit_att._json_temp_sku_data[k].price=$("#"+m+" .J_sku_price").val(),admin_item_edit_att._json_temp_sku_data[k].stock=$("#"+m+" .J_sku_stock").val(),admin_item_edit_att._json_temp_sku_data[k].sku_code=$("#"+m+" .J_sku_code").val(),admin_item_edit_att._json_temp_sku_data[k].bar_code=$("#"+m+" .J_sku_bar_code").val()}$("#J_sku_list table").html(""),admin_item_edit_att._make_sku_list(),admin_item_edit._listen_sku_upload()})},_remove_set_sku_html:function(){if($(".J_att_type").eq(0).attr("checked"))$(".J_no_att_type").css("display",""),$(".J_sku_title").css("display","none").val(""),$(".J_sku_title").find("input").val(""),$(".J_set_sku").remove(),$("#J_sku_list").css("display","none"),$("#J_sku_list input").attr("disabled",!0);else if($(".J_att_type").eq(1).attr("checked")){$("#J_sku_list input").attr("disabled",!1);for(var a=$(".J_sku_1_value"),b=$(".J_sku_2_value"),c=0;c<a.length;c++)for(var d=1;d<b.length;d++)admin_item_edit_att._remove_sku_list_html(c,d);$(".J_sku_title").eq(0).css("display",""),$(".J_sku_title").eq(1).css("display","none"),$(".J_sku_title").eq(1).find("input").val(""),$(".J_set_sku").eq(1).remove(),$(".J_sku_list_title").eq(1).css("display","none");for(var e=$("#J_sku_list tr:gt(0)"),c=0;c<e.length;c++)8==e.eq(c).children("td").length?e.eq(c).children("td").eq(1).css("display","none"):e.eq(c).children("td").eq(0).css("display","none");admin_item_edit_att._make_sku_list()}},_listen_set_sku:function(){var a=$(".J_set_sku").find("input");a.unbind("keyup"),a.keyup(function(){admin_item_edit_att._make_sku_list(),admin_item_edit._listen_sku_upload()})},_make_sku_list:function(a){"undefined"==typeof a&&(a=!1),$("#J_sku_list").css("display","");var b=$(".J_sku_1_value"),c=$(".J_sku_2_value"),d=$("#J_sku_list").find("tr"),e=new Array;d=e;for(var f=(new Array,0);f<b.length;f++)if(c.length>0)for(var g=0;g<c.length;g++)admin_item_edit_att._make_sku_list_html(f,g),a&&admin_item_edit_att.set_sku_data(f,g);else{var g=0;admin_item_edit_att._make_sku_list_html(f,g),a&&admin_item_edit_att.set_sku_data(f,g)}},set_sku_data:function(a,b){if("undefined"==typeof admin_item_edit_att._json_att_type.item_sku)return!1;var c="J_sku_list_"+a+"_"+b,d=admin_item_edit_att._json_att_type.sku_1,e=admin_item_edit_att._json_att_type.sku_2,f=d[a].id;if(""==e)var g=0;else var g=e[b].id;var h=admin_item_edit_att._json_att_type.item_sku[f+"_"+g];if(0==b&&h.pic){var i='<span style=" display:table;"><em style="display:table-cell;text-align:center;vertical-align:middle; height:40px;"><img width="40" src="'+h.pic+'"></em><input class="J_sku_pic" type="hidden" value="'+h.pic+'"></span>';$(".J_sku_pic_list").eq(a).html(i)}$("#"+c+" .J_sku_price").val(h.price),$("#"+c+" .J_sku_sales_price").val(h.sales_price),$("#"+c+" .J_sku_stock").val(h.stock),$("#"+c+" .J_sku_free_buy_stock").val(h.free_buy_stock),$("#"+c+" .J_sku_code").val(h.sku_code),$("#"+c+" .J_sku_bar_code").val(h.bar_code)},_make_sku_list_html:function(a,b){var c="J_sku_list_"+a+"_"+b,d=$(".J_sku_1_value").eq(a),e=$(".J_sku_2_value").eq(b),f=$("#J_sku_list").find("table"),g=$(".J_sku_title"),h=g.eq(0).find("input").val(),i=g.eq(1).find("input").val(),j="";if(""==f.html()&&(j='<tr><th class="J_sku_list_title"></th><th class="J_sku_list_title"></th><th class="width_a">价格(元)</th></tr>',f.append(j)),$(".J_sku_list_title").eq(0).html(h),$(".J_sku_list_title").eq(1).html(i).css("display",""),0==$("#"+c).length){j='<tr id="'+c+'">',0==b&&(j+='<td><div style="position:relative;"><a href="javascript:;" class="img_upload nico J_sku_pic_list"><input class="J_sku_pic" type="hidden" value=""></a><input type="file" accept="image/*" name="pic" style="position:absolute;left:0;top:0;width:300px;height:40px;filter:alpha(opacity=0);-moz-opacity:0;opacity:0;cursor:pointer;" class="J_sku_pic_upload_btn" accept="image/*"></div><span class="J_sku_list_title_1"></span></td>'),j+='<td class="J_sku_list_title_'+a+'_2"></td><td><input class="text_a J_sku_price" name="sku_price[]"></td></tr>',0==b?f.append(j):$(j).insertAfter("#J_sku_list_"+a+"_"+(b-1));var k=$("#J_price").val();$("#"+c+" .J_sku_price").val(k);var k=$("#J_sales_price").val();$("#"+c+" .J_sku_sales_price").val(k)}if(0==b){var l=$(".J_sku_2_value").length;l=l?l:1,$("#"+c).children("td").eq(0).attr("rowspan",l)}var m=admin_item_edit_att._json_temp_sku_data[a+"_"+b];if("undefined"!=typeof m){if(0==b&&m.pic){var j='<span style=" display:table;"><em style="display:table-cell;text-align:center;vertical-align:middle; height:40px;"><img src="'+resize_img(m.pic,40)+'"></em><input class="J_sku_pic" type="hidden" value="'+m.pic+'"></span>';$(".J_sku_pic_list").eq(a).html(j)}$("#"+c+" .J_sku_price").val(m.price),$("#"+c+" .J_sku_sales_price").val(m.sales_price),$("#"+c+" .J_sku_stock").val(m.stock),$("#"+c+" .J_sku_free_buy_stock").val(m.free_buy_stock),$("#"+c+" .J_sku_code").val(m.sku_code),$("#"+c+" .J_sku_bar_code").val(m.bar_code)}return $("#"+c+" .J_sku_list_title_1").html(d.val()),$("#"+c+" .J_sku_list_title_"+a+"_2").html(e.val()),"none"==g.eq(1).css("display")?($(".J_sku_list_title").eq(1).css("display","none"),$("#"+c+" .J_sku_list_title_"+a+"_2").css("display","none")):($(".J_sku_list_title").eq(1).css("display",""),$("#"+c+" .J_sku_list_title_"+a+"_2").css("display","")),!0},_remove_sku_list_html:function(a,b){var c="J_sku_list_"+a+"_"+b;return $("#"+c).length<=0?!1:void $("#"+c).remove()}},admin_item_edit_verify={_verify:function(){$(".J_data_format").remove();var a=$("#J_language");if(a.length>0&&a.val()<=0)return make_alert_html(arr_language.warn,arr_language.error_2),!1;var b=$("#J_cid_1");if(b.val()<=0)return make_alert_html(arr_language.warn,arr_language.mall.item.error_1),!1;var c=$("#J_cid_2");if("none"!=c.css("display")&&c.val()<=0)return make_alert_html(arr_language.warn,arr_language.mall.item.error_1),!1;var d=$("#J_title");if(!d.val())return make_alert_html(arr_language.warn,arr_language.mall.item.error_2),!1;var e=$("#J_price");if(!e.val()||parseFloat(e.val())<=0)return make_alert_html(arr_language.warn,arr_language.mall.item.error_5),!1;var a=$(".J_has_pic");if(a.length<=0)return make_alert_html(arr_language.warn,arr_language.mall.item.error_3),!1;for(var f=$(".J_att_type"),g=0,h=0;h<f.length;h++){var i=f.eq(h);if(i.attr("checked")){g=i.val();break}}if(g>0){var j=new Array;if(!(j=admin_item_edit_verify._verify_sku_value(1)))return!1;if(2==g&&!admin_item_edit_verify._verify_sku_value(2,j))return!1;if(!admin_item_edit_verify._verify_sku_info())return!1}return!0},_append_input_hidden:function(a,b){var c='<input class="J_data_format" type="hidden" name="'+a+'" value="'+b+'">';$("#J_send_form").append(c)},_verify_sku_info:function(){for(var a=$(".J_sku_price"),b=0;b<a.length;b++){var c=a.eq(b),d=c.parent().parent().attr("id"),e=admin_item_edit_verify._make_sku_name(d);if(""==$.trim(c.val()))return make_alert_html(arr_language.notice,arr_language.mall.item.error_7.replace("$s$",e)),!1;if(!c.val().match(/^[\d]+(|\.[\d]+)$/))return make_alert_html(arr_language.notice,arr_language.mall.item.error_7.replace("$s$",e)),!1}return!0},_verify_sku_value:function(a,b){var c=$(".J_sku_"+a+"_value");if("undefined"==typeof b)var b=new Array;for(var d=0;d<c.length;d++){var e=c.eq(d);if(""==$.trim(e.val()))return make_alert_html(arr_language.notice,arr_language.mall.item.error_9),!1;if(e.val().split("|").length>1)return make_alert_html(arr_language.notice,arr_language.mall.item.error_10.replace("$s$",e.val())),!1;if("undefined"!=typeof b[e.val()])return make_alert_html(arr_language.notice,arr_language.mall.item.error_11.replace("$s$",e.val())),!1;b[e.val()]=1}return b},_make_sku_name:function(a){var a=a.split("_"),b=a[3],c=a[4],d="",e=$(".J_sku_1_value"),f=$(".J_sku_2_value");return d=e.eq(b).val(),0==f.length?d:d+="-"+f.eq(c).val()},_data_format:function(){$(".J_data_format").remove();for(var a=$(".J_att_type"),b=0,c=0;c<a.length;c++){var d=a.eq(c);if(d.attr("checked")){b=d.val();break}}if(0==b)return admin_item_edit_verify._append_input_hidden("sku_1[]",""),admin_item_edit_verify._append_input_hidden("sku_2[]",""),admin_item_edit_verify._append_input_hidden("sku_price[]",$("#J_price").val()),admin_item_edit_verify._append_input_hidden("sku_sales_price[]",$("#J_sales_price").val()),admin_item_edit_verify._append_input_hidden("sku_stock[]",$("#J_stock").val()),admin_item_edit_verify._append_input_hidden("sku_free_buy_stock[]",$("#J_free_buy_stock").val()),admin_item_edit_verify._append_input_hidden("sku_code[]",$("#J_item_code").val()),admin_item_edit_verify._append_input_hidden("sku_bar_code[]",$("#J_bar_code").val()),!1;for(var e=$(".J_sku_1_value"),f=$(".J_sku_2_value"),c=0;c<e.length;c++)if(f.length>0)for(var g=0;g<f.length;g++)admin_item_edit_verify.sku_data_format(c,g);else{var g=0;admin_item_edit_verify.sku_data_format(c,g)}},sku_data_format:function(a,b){var c=$(".J_sku_1_value"),d=$(".J_sku_2_value"),e=c.eq(a).val(),f=c.eq(a).attr("data-sku-id");f>0&&(e=f+"|"+e),admin_item_edit_verify._append_input_hidden("sku_1[]",e),d.length>0?(e=d.eq(b).val(),f=d.eq(b).attr("data-sku-id"),f>0&&(e=f+"|"+e),admin_item_edit_verify._append_input_hidden("sku_2[]",e)):admin_item_edit_verify._append_input_hidden("sku_2[]","");var g=$(".J_sku_pic").eq(a);return e=1==g.length?g.val():"",admin_item_edit_verify._append_input_hidden("sku_pic[]",e),!0}},admin_item_search={_init:function(){admin_item_search._listen_cat()},_listen_cat:function(){var a=$("#J_cid_1");a.change(function(){var a=$(this),b=a.val(),c=window.location.href.replace(/\&(cid_1|cid_2|cid_3)=[\d]+/g,"");window.location.href=c+"&cid_1="+b});var b=$("#J_cid_2");b.change(function(){var a=$(this),b=a.val(),c=window.location.href.replace(/\&(cid_2|cid_3)=[\d]+/g,"");window.location.href=c+"&cid_2="+b});var c=$("#J_language");c.change(function(){var a=$(this),b=a.val(),c=window.location.href.replace(/\&language=[a-z_]+/,"");window.location.href=c+"&language="+b})}},admin_item_pics={uploading:!1,pic_max_num:5,_init:function(){var a=admin_item_pics;a._listen_pic_upload_btn();for(var b=$("#J_pic_list input"),c="",d=0;d<b.length;d++){var e=b.eq(d).val(),f=b.eq(d).attr("data-pid");c=a.make_pic_html(d,e,f),$("#J_pic_list").children("li").eq(d).html(c),d>=a.pic_max_num-1&&$("#J_pic_upload").css("display","none")}a._listen_move_del_pic()},_listen_pic_upload_btn:function(){var a=admin_item_pics;$("#J_pic_upload_btn").change(function(){return a.uploading?(make_alert_html(arr_language.warn,arr_language.mall.item.error_12),!1):($("#J_do").val("upload_image"),setTimeout(function(){_ajax_frame(get_obj("ajaxframeid"),a._pic_upload_success,"send_success"),get_obj("J_send_form").submit()},10),$(".J_sku_pic_upload_btn").attr("disabled",!0),a.uploading=!0,$("#J_form_do").val("upload"),void $("#J_pic_upload_status").val(arr_language.upload.uploading))})},_pic_upload_success:function(a){var b=admin_item_pics;if($("#J_form_do").val(""),$(".J_sku_pic_upload_btn").attr("disabled",!1),b.uploading=!1,$("#J_pic_upload_status").val(arr_language.upload.upload),_remove_ajax_frame("send_success"),200==a.status){var c=$("#J_pic_list").children("li"),d=$(".J_has_pic").length;c.eq(d).html(b.make_pic_html(d,a.data)),d>=b.pic_max_num-1&&$("#J_pic_upload").css("display","none"),b._reset_listen_move_del_pic()}else make_alert_html(arr_language.warn,arr_language.error_1)},make_pic_html:function(a,b){var c=_html_move_del_btn=left_btn_style=right_btn_style="";0==a&&(left_btn_style=' style="display:none;"'),4==a&&(right_btn_style=' style="display:none;"'),_html_move_del_btn="<i"+left_btn_style+' class="J_move_pic_left nico g_l" title="向左移"><!--左--></i>',_html_move_del_btn+="<i"+right_btn_style+' class="J_move_pic_right nico g_r" title="向右移"><!--右--></i>',_html_move_del_btn+='<i class="J_del_pic nico g_c" title="删除"><!--删除--></i>';var c='<div class="goods_nav J_has_pic">';return c+=_html_move_del_btn+"</div>",c+='<span><img src="'+b+'"></span>',c+='<input type="hidden" name="pic[]" value="'+b+'">'},_listen_move_del_pic:function(){var a=admin_item_pics;$(".J_move_pic_left").click(function(){var b=$(".J_move_pic_left").index(this);a._move_pic(b,"left")}),$(".J_move_pic_right").click(function(){var b=$(".J_move_pic_right").index(this);a._move_pic(b,"right")}),$(".J_del_pic").click(function(){var b=$(".J_del_pic").index(this);a._del_pic(b)})},_remove_listen_move_del_pic:function(){$(".J_move_pic_left").unbind("click"),$(".J_move_pic_right").unbind("click"),$(".J_del_pic").unbind("click")},_reset_listen_move_del_pic:function(){var a=admin_item_pics;a._remove_listen_move_del_pic(),a._listen_move_del_pic();var b=$(".J_has_pic");b.children(".J_move_pic_left").css("display",""),b.children(".J_move_pic_right").css("display",""),b.eq(0).children(".J_move_pic_left").css("display","none"),b.eq(b.length-1).children(".J_move_pic_right").css("display","none")},_move_pic:function(a,b){var c=admin_item_pics,d=$("#J_pic_list").children("li").eq(a);if("left"==b){var e=$("#J_pic_list").children("li").eq(a-1);e.before(d)}else if("right"==b){var e=$("#J_pic_list").children("li").eq(a+1);d.before(e)}c._reset_listen_move_del_pic()},_del_pic:function(a){var b=admin_item_pics;if(!confirm(arr_language.del_2))return!1;b._remove_listen_move_del_pic();var c=$("#J_pic_list").children("li").eq(a),d=new Object;d.filename=c.children("input").val(),d.pid=c.children("input").attr("data-pid"),d.item_id=$("#J_item_id").val(),c.remove(),0==$(".J_has_pic").length?$("#J_pic_list").children("li").eq(0).before("<li><font><em>*</em> "+arr_language.mall.main_pic+"</font></li>"):$("#J_pic_list").append("<li></li>"),$("#J_pic_upload").css("display",""),b._reset_listen_move_del_pic()}};